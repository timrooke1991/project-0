"use strict";var _slicedToArray=function(){function e(e,a){var o=[],s=!0,t=!1,r=void 0;try{for(var n,l=e[Symbol.iterator]();!(s=(n=l.next()).done)&&(o.push(n.value),!a||o.length!==a);s=!0);}catch(e){t=!0,r=e}finally{try{!s&&l.return&&l.return()}finally{if(t)throw r}}return o}return function(a,o){if(Array.isArray(a))return a;if(Symbol.iterator in Object(a))return e(a,o);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();$(function(){function e(){44===g&&(h.text("That's half-time!"),k=!k,y.text("Play")),90===g?(h.text("That's full-time!"),clearInterval(x),y.text("Finish")):(g++,d.text(g))}function a(e){return Math.floor(Math.random()*e)}function o(){var e=document.getElementById("homeBar");b=w.averagePlayerValues("attack")+a(10),e.style.width=b+"%"}function s(){return a(w.averagePlayerValues("creativity"))>=a(v.averagePlayerValues("creativity"))?(h.css("background-color",w.colors[0]),h.css("color",w.colors[1]),h.text("The home team launch an attack"),[w,"home",v]):(h.css("background-color",v.colors[0]),h.css("color",v.colors[1]),h.text("The away are attacking"),[v,"away",w])}function t(e,o,s){var t=null,r=null,n=e.randomPlayer(),l=s.randomPlayerByPosition("defender");a(n.attack)>a(l.defence)&&("home"===o?(r=u.text(),t=parseFloat(r)+1,u.text(t)):(r=f.text(),t=parseFloat(r)+1,f.text(t)),p("goal",n),$("#"+o+"Events").append("<i class='fa fa-futbol-o' style='font-size: 22px; color:white; padding-top:5px' aria-hidden='true'></i> "+g+" mins: "+n.name+" scored<br/>"))}function r(e,o,s){console.log("YELLOW");var t=s.randomPlayer(),r="home"===o?"away":"home";a(t.discipline)+(100-g)<90&&("Yellow"===t.status?(h.css("background-color","#FF0000"),h.css("color","#FFFFFF"),p("secondYellow",t),$("#"+r+"Events").append("<i class='fa fa-square event-item' style='font-size: 24px; color: red; padding-top:5px' aria-hidden='true'></i> "+g+" mins: "+t.name+" sent off<br/>"),t.status="Ejected",t.playing=!1):(h.css("background-color","yellow"),h.css("color","#000000"),p("yellow",t),$("#"+r+"Events").append("\n          <i class='fa fa-square event-item' style='font-size: 24px; color: yellow; padding-top:5px' aria-hidden='true'></i> "+g+" mins: "+t.name+" booked<br/>"),t.status="Yellow"))}function n(e,o){var s=e.randomPlayer();a(101)%8==0?(p("injury",s),$("#"+o+"Events").append("<i class='fa fa-plus' style='font-size: 26px; color: green; padding-top:5px' aria-hidden='true'></i> "+g+" mins: "+s.name+" injured<br/>"),s.playing=!1):h.text(s.name+"'s limping, but he'll be okay")}function l(e,a,o){var s=e.randomPlayerByPosition("midfielder"),t=o.randomPlayerByPosition("goalkeeper").defence+o.averagePlayerValues("defender");if(s.attack>t){var r=null,n=null;"home"===a?(n=u.text(),r=parseFloat(n)+1,u.text(r)):(n=f.text(),r=parseFloat(n)+1,f.text(r)),p("freekick",s),$("#"+a+"Events").append("<i class='fa fa-futbol-o' style='font-size: 22px; color:white; padding-top:5px' aria-hidden='true'></i> "+g+" mins: "+s.name+" scored<br/>")}else p("wastedFreekick",s)}function c(e,o,s){var t=e.randomPlayerByPosition("striker"),r=s.randomPlayerByPosition("goalkeeper"),n=s.randomPlayerByPosition("defender"),l="home"===o?"away":"home";if(a(100)>25&&(n.status="Yellow",$("#"+l+"Events").append("<i class='fa fa-square event-item' style='font-size: 24px; color: yellow; padding-top:5px' aria-hidden='true'></i> "+g+" mins: "+n.name+" booked<br/>")),2*a(t.attack)>a(r.defence)){var c=null,i=null;"home"===o?(i=u.text(),c=parseFloat(i)+1,u.text(c)):(i=f.text(),c=parseFloat(i)+1,f.text(c)),p("penalty",t),$("#"+o+"Events").append("<i class='fa fa-futbol-o' style='font-size: 22px; color:white; padding-top:5px' aria-hidden='true'></i> "+g+" mins: "+t.name+" scores penalty<br/>")}else h.text("He's missed it! The pressure has got to him"),$("#"+o+"Events").append("<i class='fa fa-futbol-o' style='font-size: 22px; color:red; padding-top:5px' aria-hidden='true'></i> "+g+" mins: "+t.name+" missed penalty<br/>")}function i(e,o){var s=e.randomPlayer();if(a(s.discipline)>75){s.playing=!1;var t="home"===o?"away":"home";p("straightRed",s),$("#"+t+"Events").append("<i class='fa fa-square' style='font-size: 24px; color: red; padding-top:5px' aria-hidden='true'></i> "+g+" mins: "+s.name+" sent off<br/>")}}function m(e,a){if(null===w){switch($(".home-team  .team-name").text(a),a){case"Tottenham":w=spurs,$(".home-team, #homeBar").css("background-color",w.colors[0]),$(".home-team").css("color",w.colors[1]);break;case"Man United":w=manUnited,$(".home-team, #homeBar").css("background-color",w.colors[0]),$(".home-team").css("color",w.colors[1]);break;case"Liverpool":w=liverpool,$(".home-team, #homeBar").css("background-color",w.colors[0]),$(".home-team").css("color",w.colors[1]);break;case"Man City":w=manCity,$(".home-team, #homeBar").css("background-color",w.colors[0]),$(".home-team").css("color",w.colors[1]);break;case"Everton":w=everton,$(".home-team, #homeBar").css("background-color",w.colors[0]),$(".home-team").css("color",w.colors[1]);break;case"Chelsea":w=chelsea,$(".home-team, #homeBar").css("background-color",w.colors[0]),$(".home-team").css("color",w.colors[1]);break;case"Leicester":w=leicester,$(".home-team, #homeBar").css("background-color",w.colors[0]),$(".home-team").css("color",w.colors[1]);break;case"Arsenal":w=arsenal,$(".home-team, #homeBar").css("background-color",w.colors[0]),$(".home-team").css("color",w.colors[1])}console.log(w)}else{switch($(".away-team .team-name").text(a),a){case"Tottenham":v=spurs,$(".away-team, .possession-bar").css("background-color",v.colors[0]),$(".away-team").css("color",v.colors[1]);break;case"Man United":v=manUnited,$(".away-team, .possession-bar").css("background-color",v.colors[0]),$(".away-team").css("color",v.colors[1]);break;case"Liverpool":v=liverpool,$(".away-team, .possession-bar").css("background-color",v.colors[0]),$(".away-team").css("color",v.colors[1]);break;case"Man City":v=manCity,$(".away-team, .possession-bar").css("background-color",v.colors[0]),$(".away-team").css("color",v.colors[1]);break;case"Everton":v=everton,$(".away-team, .possession-bar").css("background-color",v.colors[0]),$(".away-team").css("color",v.colors[1]);break;case"Chelsea":v=chelsea,$(".away-team, .possession-bar").css("background-color",v.colors[0]),$(".away-team").css("color",v.colors[1]);break;case"Leicester":v=leicester,$(".away-team, .possession-bar").css("background-color",v.colors[0]),$(".away-team").css("color",v.colors[1]);break;case"Arsenal":v=arsenal,$(".away-team, .possession-bar").css("background-color",v.colors[0]),$(".away-team").css("color",v.colors[1])}console.log(v)}console.log(a)}function p(e,o){var s={goal:["Goal!","He's scored!","That's a great finish!","What a goal by "+o.name,o.name+" finishes off the move!"],freekick:["It's a freekick",o.name+" to take the freekick","He lines up the freekick","This is a chance to get a cross in"],wastedFreekick:[o.name+" loses possession","That's ended up in row Z","The attack amounts to nothing",o.name+" has wasted that opportunity",o.name+"'s effort goes over the bar","He hands back possession to the other team"],yellow:["He's going in the book","Ouch! "+o.name+"'ll a yellow for that","That's a booking","It's a yellow!","The ref is taking his name"],secondYellow:["He's already been booked...","That's a second yellow",o.name+" is shown a red!",o.name+" is off"],straightRed:[o.name+" is shown a straight red!",o.name+" is off","The ref has given him straight red!"],penalty:["The referee points to the spot","That's a penalty",o.name+" is fouled in the area","The ref blows his whistle. Penalty."],injury:[o.name+"'s is going off",o.name+" is injured",o.name+" can't continue"]},t=a(s[e].length),r=s[e][t];h.text(""+r)}var d=$(".changing-minutes"),h=$("#commentaryBox"),y=$(".primary-button"),u=$(".home-team .score"),f=$(".away-team .score"),g=0,k=!1,b=50,w=null,v=null,x=setInterval(function(){if(k){var m=a(100)+1;console.log(g+": "+m);var p=s(),d=_slicedToArray(p,3),h=d[0],y=d[1],u=d[2];m%18==0&&t(h,y,u),m%80==0&&c(h,y,u),m%90==0&&i(u,y),m%22==0&&l(h,y,u),m%14==0&&r(h,y,u),m%60==0&&n(h,y),o(),e()}},200);$(".team-input").on("click",function(e){var a=e.target.innerHTML;null===w?(m(w,a),console.log("homeTeam now selected!"),$(".title-message").text("Home team chosen. Now chose your opponent.")):(m(v,a),console.log("awayTeam now selected!"),$("#match-setup, .info-message").hide(),$("#match-engine, .away-team, .home-team, .timer").show())}),$("#revealTeam").on("click",function(){$(".team-display").html("");var e=["1"].concat(w.formation.split("-")),a=["goalkeeper","defender","midfielder","striker"],o=0,s=0;try{e.map(function(e){for(var t=parseFloat(e),r=0;r<t;)w.players[o].playing&&($(".team-display").append("<p>"+a[s]+": "+w.players[o].name+"</p>"),w.players[o].chosenPosition=a[s],r++),console.log(o),o++;$(".team-display").append("<hr>"),s++})}catch(e){alert("Select 11 players!")}}),$(".player-selection-box button").on("click",function(){$(".team-panel").html("");var e=["goalkeeper","defender","midfielder","striker"];w.players.sort(function(a,o){return e.indexOf(a.position)<e.indexOf(o.position)?-1:1});for(var a=0;a<w.players.length;a++){var o=w.players[a],s=o.playing?"&#10004;":"&#10007;";$(".team-panel").append('<p class="player-line" id=\''+o.name+'\'>\n          <span class="starting" id="'+a+'">'+s+'</span>\n          <span class="player-name">'+o.position+" "+o.name+'</span>\n          <span class="player-stat">'+o.attack+'</span>\n          <span class="player-stat">'+o.defence+"</span>\n        </p>")}}),$(".team-panel").on("click",function(e){var a=e.target.id;w.players[a].playing=!w.players[a].playing,console.log(w.players[a].playing),w.players[a].playing?$("#"+a).html("&#10004;"):$("#"+a).html("&#10007;")}),y.on("click",function(){k=!k,k?y.text("Pause"):y.text("Play")}),$(".select-btn").on("click",function(){$(".match-setup").hide(),$(".team-setup").show()})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyIkIiwiJGNvbW1lbnRhcnlCb3giLCJ0ZXh0IiwiJHByaW1hcnlCdXR0b24iLCJydW4iLCJtYXRjaFRpbWUiLCIkbWF0Y2hUaW1lIiwibW92ZSIsInZhbHVlIiwiZWxlbSIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJ3aWR0aCIsInNlbGVjdFRlYW0iLCJhdmVyYWdlUGxheWVyVmFsdWVzIiwiZ2VuUmFuZG9tVmFsdWUiLCJob21lUmFuZG9tIiwiaG9tZVRlYW0iLCJjb2xvcnMiLCJjc3MiLCJhd2F5VGVhbSIsInNlbGVjdFBsYXllciIsInRlYW0iLCJhdHRhY2tpbmdQbGF5ZXIiLCJhdHRhY2tpbmdUZWFtIiwicmFuZG9tUGxheWVyIiwic2NvcmUiLCJ0ZWFtU3RyaW5nIiwiZ2V0U2NvcmUiLCIkaG9tZVNjb3JlIiwicmFuZG9tUGxheWVyQnlQb3NpdGlvbiIsImF0dGFjayIsImRlZmVuZGluZ1BsYXllciIsImRlZmVuY2UiLCIkYXdheVNjb3JlIiwicGFyc2VGbG9hdCIsImdlbmVyYXRlQ29tbWVudGFyeSIsImhhbmRsZURpc2NpcGxpbmUiLCJuYW1lIiwiZGlzY2lwbGluZSIsImRlZmVuZGluZ1RlYW0iLCJjb25zb2xlIiwibG9nIiwic3RhdHVzIiwiYXBwZW5kIiwicGxheWluZyIsImhhbmRsZUZyZWVraWNrIiwiZGVmZW5kaW5nVmFsdWUiLCJoYW5kbGVQZW5hbHR5IiwiYm9va2VkUGxheWVyIiwic3RyYWlnaHRSZWQiLCJzZWxlY3RvciIsInNwdXJzIiwibWFuVW5pdGVkIiwibGl2ZXJwb29sIiwibWFuQ2l0eSIsImV2ZXJ0b24iLCJjaGVsc2VhIiwibGVpY2VzdGVyIiwiYXJzZW5hbCIsInNjZW5hcmlvIiwiZnJlZWtpY2siLCJzZWNvbmRZZWxsb3ciLCJwbGF5ZXIiLCJyYW5kb21lSW5kZXgiLCJnb2FsIiwibWVzc2FnZSIsImNvbW1lbnRhcnkiLCJ3YXN0ZWRGcmVla2ljayIsInllbGxvdyIsInBlbmFsdHkiLCJpbmp1cnkiLCJsZW5ndGgiLCJzZXRJbnRlcnZhbCIsInRpbWVySUQiLCJldmVudFZhbHVlIiwiX3NlbGVjdFRlYW0iLCJfc2VsZWN0VGVhbTIiLCJfc2xpY2VkVG9BcnJheSIsImdvYWxDaGFuY2UiLCJoYW5kbGVJbmp1cnkiLCJ0aW1lQ29udHJvbCIsIm9uIiwiZSIsInVzZXJUZWFtIiwidGFyZ2V0IiwiaW5uZXJIVE1MIiwiY29uZmlnVGVhbSIsImhpZGUiLCJzaG93IiwiaHRtbCIsImZvcm1hdGlvbiIsInNwbGl0IiwicGxheWVyTnVtYmVyIiwicG9zaXRpb25OdW1iZXIiLCJtYXAiLCJhcnJheUl0ZW0iLCJpdGVyYXRpb25zIiwiaSIsInBsYXllcnMiLCJjb25jYXQiLCJwb3NpdGlvbnMiLCJjaG9zZW5Qb3NpdGlvbiIsInNvcnQiLCJhIiwiYiIsImVyciIsImluZGV4T2YiLCJwb3NpdGlvbiIsInN0YXJ0aW5nRWxldmVuIiwic2VsZWN0ZWRQbGF5ZXIiXSwibWFwcGluZ3MiOiJtY0FBQUEsR0FBRSxXQW1LSUMsUUFBQUEsS0FFZUMsS0FBZkMsSUFDREYsRUFBQUMsS0FBQSxxQkFGQ0UsR0FBT0EsRUFJVEQsRUFBR0UsS0FBa0IsU0FHSkgsS0FBZkMsR0FIRkYsRUFJT0MsS0FKUCxxQkFLRUcsY0FBQUEsR0FDQUMsRUFBQUosS0FBZ0JHLFlBR25CQSxJQUhHQyxFQUFXSixLQUFLRyxJQVNwQixRQUFTRSxHQUFPQyxHQUNkLE1BQU1DLE1BQU9DLE1BQUFBLEtBQVNDLFNBQWVILEdBR3RDLFFBQUFELEtBSEMsR0FBTUUsR0FBT0MsU0FBU0MsZUFBZSxVQUt2Q0MsR0FBU0MsRUFBVEMsb0JBQXNCLFVBQUFDLEVBQUEsSUFDcEJOLEVBQU1PLE1BQUFBLE1BQWNELEVBQUFBLElBR3BCLFFBQUlDLEtBSUYsTUFIQUQsR0FBbUJFLEVBQW9CQSxvQkFBdkMsZ0JBQ0FGLEVBQTRCRSxFQUFTQyxvQkFBckMsZ0JBRkZqQixFQUtPa0IsSUFBQSxtQkFBQUYsRUFBQUMsT0FBQSxJQUNMakIsRUFBZWtC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QUoxRUosUUFBQUMsSUFBQXpCLEVBQUFrRixRQUFBVyxHQUFBakUsU0FJRTVCLEVBQVNrRixRQUFRVyxHQUFnQmpFLFFBQVU3QyxFQUFBQSxJQUFNOEcsR0FBa0JwQixLQUFLLFlBQWMxRixFQUFBQSxJQUFNOEcsR0FBa0JwQixLQUFLLGNBT3BIdkYsRUFIRCtFLEdBQUEsUUFBQSxXQUNFOUUsR0FBT0EsRUFJUEEsRUFBQUQsRUFBa0JELEtBQXBCLFNBQTZCQyxFQUFNRCxLQUFBLFVBR2xDRixFQUhELGVBQUFrRixHQUFBLFFBQUEsV0FDRWxGLEVBQUUsZ0JBQWdCd0YsT0FJcEJ4RixFQUFBLGVBQUF5RiIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyIkKCgpID0+IHtcbiAgY29uc3QgJG1hdGNoVGltZSA9ICQoJy5jaGFuZ2luZy1taW51dGVzJyk7XG4gIGNvbnN0ICRjb21tZW50YXJ5Qm94ID0gJCgnI2NvbW1lbnRhcnlCb3gnKTtcbiAgY29uc3QgJHByaW1hcnlCdXR0b24gPSAkKCcucHJpbWFyeS1idXR0b24nKTtcbiAgY29uc3QgJGhvbWVTY29yZSA9ICQoJy5ob21lLXRlYW0gLnNjb3JlJyk7XG4gIGNvbnN0ICRhd2F5U2NvcmUgPSAkKCcuYXdheS10ZWFtIC5zY29yZScpO1xuICAvLyBjb25zdCAkaG9tZVRlYW0gPSAkKCcuaG9tZS10ZWFtJyk7XG4gIC8vIGNvbnN0ICRhd2F5VGVhbSA9ICQoJy5hd2F5LXRlYW0nKTtcblxuXG4gIGxldCBtYXRjaFRpbWUgPSAwO1xuICBsZXQgcnVuID0gZmFsc2U7XG4gIGxldCB3aWR0aCA9IDUwO1xuICBsZXQgaG9tZVRlYW0gPSBudWxsO1xuICBsZXQgYXdheVRlYW0gPSBudWxsO1xuXG5cbiAgLy8gTUFUQ0ggTE9HSUNcbiAgY29uc3QgdGltZXJJRCA9IHNldEludGVydmFsKGZ1bmN0aW9uKCkge1xuICAgIGlmIChydW4pIHtcblxuICAgICAgY29uc3QgZXZlbnRWYWx1ZSA9IGdlblJhbmRvbVZhbHVlKDEwMCkgKyAxO1xuICAgICAgY29uc29sZS5sb2coYCR7bWF0Y2hUaW1lfTogJHtldmVudFZhbHVlfWApO1xuXG4gICAgICAvLyBDcmVhdGl2aXR5IFN1bUNyZWF0aXZpdHkgdnMuIFN1bUNyZWF0aXZpdHlcbiAgICAgIGNvbnN0IFthdHRhY2tpbmdUZWFtLCB0ZWFtU3RyaW5nLCBkZWZlbmRpbmdUZWFtXSA9IHNlbGVjdFRlYW0oKTtcblxuICAgICAgLy8gY29uc3QgY2hvc2VuUGxheWVyID0gc2VsZWN0UGxheWVyKHRlYW1PYmplY3QpO1xuICAgICAgLy8gY29uc29sZS5sb2coY2hvc2VuUGxheWVyKTtcbiAgICAgIC8vIFdobyBoYXMgdGhlIGV2ZW50P1xuICAgICAgaWYgKGV2ZW50VmFsdWUgJSAxOCA9PT0gMCkge1xuICAgICAgICAvLyBSYW5kb20gKFN0cmlrZXIsIE1pZGZpZWxkZXIpIHZzLiBHb2Fsa2VlcGVyID4gUmFuZFRoZWlyQXR0YWNrIHZzLiBSYW5kR29hbGtlZXBlclxuICAgICAgICBnb2FsQ2hhbmNlKGF0dGFja2luZ1RlYW0sIHRlYW1TdHJpbmcsIGRlZmVuZGluZ1RlYW0pO1xuICAgICAgfVxuXG4gICAgICBpZiAoZXZlbnRWYWx1ZSAlIDgwID09PSAwKSB7XG4gICAgICAgIC8vIFN0cmlrZXIgdnMuIEdvYWxrZWVwZXIgPiBSYW5kVGhlaXJBdHRhY2sgdnMuIFJhbmRHb2Fsa2VlcGVyUGVuYWx0eVxuICAgICAgICBoYW5kbGVQZW5hbHR5KGF0dGFja2luZ1RlYW0sIHRlYW1TdHJpbmcsIGRlZmVuZGluZ1RlYW0pO1xuICAgICAgfVxuICAgICAgLy9cbiAgICAgIGlmIChldmVudFZhbHVlICUgOTAgPT09IDApIHtcbiAgICAgICAgLy8gUmFuZG9tIFBsYXllciA9PiBEaXNjaXBsaW5lID4gcmFuZG9tXG4gICAgICAgIHN0cmFpZ2h0UmVkKGRlZmVuZGluZ1RlYW0sIHRlYW1TdHJpbmcpO1xuICAgICAgfVxuICAgICAgLy9cbiAgICAgIGlmIChldmVudFZhbHVlICUgMjIgPT09IDApIHtcbiAgICAgICAgLy8gU3RyaWtlciB2cy4gR29hbGtlZXBlciA+IFJhbmRUaGVpckZyZWVraWNrIHZzLiBSYW5kR29hbGtlZXBlclBlbmFsdHlcbiAgICAgICAgaGFuZGxlRnJlZWtpY2soYXR0YWNraW5nVGVhbSwgdGVhbVN0cmluZywgZGVmZW5kaW5nVGVhbSk7XG4gICAgICB9XG5cbiAgICAgIGlmIChldmVudFZhbHVlICUgMTQgPT09IDApIHtcbiAgICAgICAgLy8gUmFuZG9tUGxheWVyID0+IGRpc2NpcGxpbmUgKyBtYXRjaHRpbWUgcmFuZCB2cy4gcmFuZG9tXG4gICAgICAgIGhhbmRsZURpc2NpcGxpbmUoYXR0YWNraW5nVGVhbSwgdGVhbVN0cmluZywgZGVmZW5kaW5nVGVhbSk7XG4gICAgICB9XG5cbiAgICAgIGlmIChldmVudFZhbHVlICUgNjAgPT09IDApIHtcbiAgICAgICAgaGFuZGxlSW5qdXJ5KGF0dGFja2luZ1RlYW0sIHRlYW1TdHJpbmcpO1xuICAgICAgfVxuXG4gICAgICAvLyBSZWR1Y2UgRml0bmVzc1xuICAgICAgbW92ZSgpO1xuICAgICAgdGltZUNvbnRyb2woKTtcbiAgICB9XG4gIH0sMjAwKTtcblxuICAvLyBFdmVudCBMaXN0ZW5lcnMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAvLyBUZWFtIHNlbGVjdGlvblxuICAkKCcudGVhbS1pbnB1dCcpLm9uKCdjbGljaycsIChlKSA9PiB7XG4gICAgY29uc3QgdXNlclRlYW0gPSBlLnRhcmdldC5pbm5lckhUTUw7XG4gICAgaWYgKGhvbWVUZWFtID09PSBudWxsKSB7XG4gICAgICBjb25maWdUZWFtKGhvbWVUZWFtLCB1c2VyVGVhbSk7XG4gICAgICBjb25zb2xlLmxvZygnaG9tZVRlYW0gbm93IHNlbGVjdGVkIScpO1xuICAgICAgJCgnLnRpdGxlLW1lc3NhZ2UnKS50ZXh0KCdIb21lIHRlYW0gY2hvc2VuLiBOb3cgY2hvc2UgeW91ciBvcHBvbmVudC4nKTtcbiAgICAgIC8vIGUuYWRkQ2xhc3MoJ3NlbGVjdGVkJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbmZpZ1RlYW0oYXdheVRlYW0sIHVzZXJUZWFtKTtcbiAgICAgIGNvbnNvbGUubG9nKCdhd2F5VGVhbSBub3cgc2VsZWN0ZWQhJyk7XG4gICAgICAkKCcjbWF0Y2gtc2V0dXAsIC5pbmZvLW1lc3NhZ2UnKS5oaWRlKCk7XG4gICAgICAkKCcjbWF0Y2gtZW5naW5lLCAuYXdheS10ZWFtLCAuaG9tZS10ZWFtLCAudGltZXInKS5zaG93KCk7XG4gICAgfVxuICB9KTtcblxuICAvLyBTdGFydGluZyBMaW5lIFVwXG4gICQoJyNyZXZlYWxUZWFtJykub24oJ2NsaWNrJywgKCkgPT4ge1xuICAgICQoJy50ZWFtLWRpc3BsYXknKS5odG1sKCcnKTtcbiAgICBjb25zdCBmb3JtYXRpb24gPSBbJzEnXS5jb25jYXQoaG9tZVRlYW0uZm9ybWF0aW9uLnNwbGl0KCctJykpO1xuICAgIGNvbnN0IHBvc2l0aW9ucyA9IFsnZ29hbGtlZXBlcicsICdkZWZlbmRlcicsICdtaWRmaWVsZGVyJywgJ3N0cmlrZXInXTtcbiAgICBsZXQgcGxheWVyTnVtYmVyID0gMDtcbiAgICBsZXQgcG9zaXRpb25OdW1iZXIgPSAwO1xuXG4gICAgdHJ5IHtcbiAgICAgIGZvcm1hdGlvbi5tYXAoKGFycmF5SXRlbSkgPT4ge1xuICAgICAgICBjb25zdCBpdGVyYXRpb25zID0gcGFyc2VGbG9hdChhcnJheUl0ZW0pO1xuICAgICAgICBsZXQgaSA9IDA7XG4gICAgICAgIHdoaWxlIChpIDwgaXRlcmF0aW9ucykge1xuICAgICAgICAgIGlmIChob21lVGVhbS5wbGF5ZXJzW3BsYXllck51bWJlcl0ucGxheWluZykge1xuICAgICAgICAgICAgJCgnLnRlYW0tZGlzcGxheScpLmFwcGVuZChgPHA+JHtwb3NpdGlvbnNbcG9zaXRpb25OdW1iZXJdfTogJHtob21lVGVhbS5wbGF5ZXJzW3BsYXllck51bWJlcl0ubmFtZX08L3A+YCk7XG4gICAgICAgICAgICBob21lVGVhbS5wbGF5ZXJzW3BsYXllck51bWJlcl0uY2hvc2VuUG9zaXRpb24gPSBwb3NpdGlvbnNbcG9zaXRpb25OdW1iZXJdO1xuICAgICAgICAgICAgaSsrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zb2xlLmxvZyhwbGF5ZXJOdW1iZXIpO1xuICAgICAgICAgIHBsYXllck51bWJlcisrO1xuICAgICAgICB9XG4gICAgICAgICQoJy50ZWFtLWRpc3BsYXknKS5hcHBlbmQoJzxocj4nKTtcbiAgICAgICAgcG9zaXRpb25OdW1iZXIrKztcbiAgICAgIH0pO1xuICAgIH0gY2F0Y2goZXJyKSB7XG4gICAgICBhbGVydCgnU2VsZWN0IDExIHBsYXllcnMhJyk7XG4gICAgfVxuICB9KTtcblxuICAkKCcucGxheWVyLXNlbGVjdGlvbi1ib3ggYnV0dG9uJykub24oJ2NsaWNrJywgKCkgPT4ge1xuICAgICQoJy50ZWFtLXBhbmVsJykuaHRtbCgnJyk7XG5cbiAgICBjb25zdCBwb3NpdGlvbnMgPSBbJ2dvYWxrZWVwZXInLCAnZGVmZW5kZXInLCAnbWlkZmllbGRlcicsICdzdHJpa2VyJ107XG4gICAgaG9tZVRlYW0ucGxheWVycy5zb3J0KGZ1bmN0aW9uKGEsYil7XG4gICAgICByZXR1cm4gcG9zaXRpb25zLmluZGV4T2YoYS5wb3NpdGlvbikgPCBwb3NpdGlvbnMuaW5kZXhPZihiLnBvc2l0aW9uKSA/IC0xIDogMTtcbiAgICB9KTtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaG9tZVRlYW0ucGxheWVycy5sZW5ndGg7IGkrKykge1xuICAgICAgY29uc3QgcGxheWVyID0gaG9tZVRlYW0ucGxheWVyc1tpXTtcbiAgICAgIGNvbnN0IHN0YXJ0aW5nRWxldmVuID0gcGxheWVyLnBsYXlpbmcgPyAnJiMxMDAwNDsnIDogJyYjMTAwMDc7JztcblxuICAgICAgJCgnLnRlYW0tcGFuZWwnKS5hcHBlbmQoXG4gICAgICAgIGA8cCBjbGFzcz1cInBsYXllci1saW5lXCIgaWQ9JyR7cGxheWVyLm5hbWV9Jz5cbiAgICAgICAgICA8c3BhbiBjbGFzcz1cInN0YXJ0aW5nXCIgaWQ9XCIke2l9XCI+JHtzdGFydGluZ0VsZXZlbn08L3NwYW4+XG4gICAgICAgICAgPHNwYW4gY2xhc3M9XCJwbGF5ZXItbmFtZVwiPiR7cGxheWVyLnBvc2l0aW9ufSAke3BsYXllci5uYW1lfTwvc3Bhbj5cbiAgICAgICAgICA8c3BhbiBjbGFzcz1cInBsYXllci1zdGF0XCI+JHtwbGF5ZXIuYXR0YWNrfTwvc3Bhbj5cbiAgICAgICAgICA8c3BhbiBjbGFzcz1cInBsYXllci1zdGF0XCI+JHtwbGF5ZXIuZGVmZW5jZX08L3NwYW4+XG4gICAgICAgIDwvcD5gXG4gICAgICApO1xuICAgIH1cbiAgfSk7XG5cblxuXG5cblxuXG4gIC8vIFRvZ2dsZSB5ZXMvbm8gcGxheWluZ1xuICAkKCcudGVhbS1wYW5lbCcpLm9uKCdjbGljaycsIChlKSA9PiB7XG4gICAgY29uc3Qgc2VsZWN0ZWRQbGF5ZXIgPSBlLnRhcmdldC5pZDtcbiAgICBob21lVGVhbS5wbGF5ZXJzW3NlbGVjdGVkUGxheWVyXS5wbGF5aW5nID0gIWhvbWVUZWFtLnBsYXllcnNbc2VsZWN0ZWRQbGF5ZXJdLnBsYXlpbmc7XG4gICAgY29uc29sZS5sb2coaG9tZVRlYW0ucGxheWVyc1tzZWxlY3RlZFBsYXllcl0ucGxheWluZyk7XG4gICAgaG9tZVRlYW0ucGxheWVyc1tzZWxlY3RlZFBsYXllcl0ucGxheWluZyA/ICQoYCMke3NlbGVjdGVkUGxheWVyfWApLmh0bWwoJyYjMTAwMDQ7JykgOiAkKGAjJHtzZWxlY3RlZFBsYXllcn1gKS5odG1sKCcmIzEwMDA3OycpO1xuXG4gIH0pO1xuXG4gICRwcmltYXJ5QnV0dG9uLm9uKCdjbGljaycsICgpID0+IHtcbiAgICBydW4gPSAhcnVuO1xuICAgIHJ1biA/ICRwcmltYXJ5QnV0dG9uLnRleHQoJ1BhdXNlJykgOiAkcHJpbWFyeUJ1dHRvbi50ZXh0KCdQbGF5Jyk7XG4gIH0pO1xuXG4gICQoJy5zZWxlY3QtYnRuJykub24oJ2NsaWNrJywgKCkgPT4ge1xuICAgICQoJy5tYXRjaC1zZXR1cCcpLmhpZGUoKTtcbiAgICAkKCcudGVhbS1zZXR1cCcpLnNob3coKTtcbiAgfSk7XG5cbiAgLy8gRnVuY3Rpb25zIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICBmdW5jdGlvbiB0aW1lQ29udHJvbCgpIHtcblxuICAgIGlmKG1hdGNoVGltZSA9PT0gNDQpIHtcbiAgICAgICRjb21tZW50YXJ5Qm94LnRleHQoYFRoYXQncyBoYWxmLXRpbWUhYCk7XG4gICAgICBydW4gPSAhcnVuO1xuICAgICAgJHByaW1hcnlCdXR0b24udGV4dCgnUGxheScpO1xuICAgIH1cblxuICAgIGlmKG1hdGNoVGltZSA9PT0gOTApIHtcbiAgICAgICRjb21tZW50YXJ5Qm94LnRleHQoYFRoYXQncyBmdWxsLXRpbWUhYCk7XG4gICAgICBjbGVhckludGVydmFsKHRpbWVySUQpO1xuICAgICAgJHByaW1hcnlCdXR0b24udGV4dCgnRmluaXNoJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIG1hdGNoVGltZSsrO1xuICAgICAgJG1hdGNoVGltZS50ZXh0KG1hdGNoVGltZSk7XG4gICAgfVxuXG4gIH1cblxuICBmdW5jdGlvbiBnZW5SYW5kb21WYWx1ZSh2YWx1ZSkge1xuICAgIHJldHVybiAoTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogdmFsdWUpKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIG1vdmUoKSB7XG4gICAgY29uc3QgZWxlbSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdob21lQmFyJyk7XG4gICAgd2lkdGggPSBob21lVGVhbS5hdmVyYWdlUGxheWVyVmFsdWVzKCdhdHRhY2snKSArIGdlblJhbmRvbVZhbHVlKDEwKTtcbiAgICBlbGVtLnN0eWxlLndpZHRoID0gd2lkdGggKyAnJSc7XG4gIH1cblxuICBmdW5jdGlvbiBzZWxlY3RUZWFtKCkge1xuICAgIGNvbnN0IGhvbWVSYW5kb20gPSAgZ2VuUmFuZG9tVmFsdWUoaG9tZVRlYW0uYXZlcmFnZVBsYXllclZhbHVlcygnY3JlYXRpdml0eScpKTtcbiAgICBjb25zdCBhd2F5UmFuZG9tID0gIGdlblJhbmRvbVZhbHVlKGF3YXlUZWFtLmF2ZXJhZ2VQbGF5ZXJWYWx1ZXMoJ2NyZWF0aXZpdHknKSk7XG5cbiAgICBpZiAoaG9tZVJhbmRvbSA+PSBhd2F5UmFuZG9tKSB7XG4gICAgICAkY29tbWVudGFyeUJveC5jc3MoJ2JhY2tncm91bmQtY29sb3InLCBob21lVGVhbS5jb2xvcnNbMF0pO1xuICAgICAgJGNvbW1lbnRhcnlCb3guY3NzKCdjb2xvcicsIGhvbWVUZWFtLmNvbG9yc1sxXSk7XG4gICAgICAkY29tbWVudGFyeUJveC50ZXh0KCdUaGUgaG9tZSB0ZWFtIGxhdW5jaCBhbiBhdHRhY2snKTtcbiAgICAgIHJldHVybiBbaG9tZVRlYW0sICdob21lJywgYXdheVRlYW1dO1xuICAgIH0gZWxzZSB7XG4gICAgICAkY29tbWVudGFyeUJveC5jc3MoJ2JhY2tncm91bmQtY29sb3InLCBhd2F5VGVhbS5jb2xvcnNbMF0pO1xuICAgICAgJGNvbW1lbnRhcnlCb3guY3NzKCdjb2xvcicsIGF3YXlUZWFtLmNvbG9yc1sxXSk7XG4gICAgICAkY29tbWVudGFyeUJveC50ZXh0KCdUaGUgYXdheSBhcmUgYXR0YWNraW5nJyk7XG4gICAgICByZXR1cm4gW2F3YXlUZWFtLCAnYXdheScsIGhvbWVUZWFtXTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBzZWxlY3RQbGF5ZXIodGVhbSkge1xuICAgIGNvbnN0IGdlblJhbmRvbUluZGV4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogdGVhbS5wbGF5ZXJzLmxlbmd0aCk7XG4gICAgcmV0dXJuIHRlYW0ucGxheWVyc1tnZW5SYW5kb21JbmRleF07XG4gIH1cblxuICBmdW5jdGlvbiBnb2FsQ2hhbmNlKGF0dGFja2luZ1RlYW0sIHRlYW1TdHJpbmcsIGRlZmVuZGluZ1RlYW0pIHtcbiAgICAvLyBSZWZhY3RvciB0aGlzXG4gICAgbGV0IHNjb3JlID0gbnVsbDtcbiAgICBsZXQgZ2V0U2NvcmUgPSBudWxsO1xuICAgIGNvbnN0IGF0dGFja2luZ1BsYXllciA9IGF0dGFja2luZ1RlYW0ucmFuZG9tUGxheWVyKCk7XG4gICAgY29uc3QgZGVmZW5kaW5nUGxheWVyID0gZGVmZW5kaW5nVGVhbS5yYW5kb21QbGF5ZXJCeVBvc2l0aW9uKCdkZWZlbmRlcicpO1xuXG4gICAgaWYgKGdlblJhbmRvbVZhbHVlKGF0dGFja2luZ1BsYXllci5hdHRhY2spID4gZ2VuUmFuZG9tVmFsdWUoZGVmZW5kaW5nUGxheWVyLmRlZmVuY2UpKSB7XG4gICAgICBpZiAodGVhbVN0cmluZyA9PT0gJ2hvbWUnKSB7XG4gICAgICAgIGdldFNjb3JlID0gJGhvbWVTY29yZS50ZXh0KCk7XG4gICAgICAgIHNjb3JlID0gcGFyc2VGbG9hdChnZXRTY29yZSkgKyAxO1xuICAgICAgICAkaG9tZVNjb3JlLnRleHQoc2NvcmUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZ2V0U2NvcmUgPSAkYXdheVNjb3JlLnRleHQoKTtcbiAgICAgICAgc2NvcmUgPSBwYXJzZUZsb2F0KGdldFNjb3JlKSArIDE7XG4gICAgICAgICRhd2F5U2NvcmUudGV4dChzY29yZSk7XG4gICAgICB9XG4gICAgICAvLyRjb21tZW50YXJ5Qm94LnRleHQoYEdvYWwhYCk7XG4gICAgICBnZW5lcmF0ZUNvbW1lbnRhcnkoJ2dvYWwnLCBhdHRhY2tpbmdQbGF5ZXIpO1xuXG4gICAgICAkKGAjJHt0ZWFtU3RyaW5nfUV2ZW50c2ApLmFwcGVuZChgPGkgY2xhc3M9J2ZhIGZhLWZ1dGJvbC1vJyBzdHlsZT0nZm9udC1zaXplOiAyMnB4OyBjb2xvcjp3aGl0ZTsgcGFkZGluZy10b3A6NXB4JyBhcmlhLWhpZGRlbj0ndHJ1ZSc+PC9pPiAke21hdGNoVGltZX0gbWluczogJHthdHRhY2tpbmdQbGF5ZXIubmFtZX0gc2NvcmVkPGJyLz5gKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBoYW5kbGVEaXNjaXBsaW5lKGF0dGFja2luZ1RlYW0sIHRlYW1TdHJpbmcsIGRlZmVuZGluZ1RlYW0pIHtcbiAgICBjb25zb2xlLmxvZygnWUVMTE9XJyk7XG4gICAgY29uc3QgZGVmZW5kaW5nUGxheWVyID0gZGVmZW5kaW5nVGVhbS5yYW5kb21QbGF5ZXIoKTtcbiAgICBjb25zdCB0ZWFtID0gdGVhbVN0cmluZyA9PT0gJ2hvbWUnID8gJ2F3YXknIDogJ2hvbWUnO1xuICAgIGlmICgoZ2VuUmFuZG9tVmFsdWUoZGVmZW5kaW5nUGxheWVyLmRpc2NpcGxpbmUpICsgKDEwMC1tYXRjaFRpbWUpKSA8IDkwKSB7XG4gICAgICAvLyBBbHJlYWR5IGJvb2tlZD8gU2VuZCBoaW0gb2ZmIVxuICAgICAgaWYgKGRlZmVuZGluZ1BsYXllci5zdGF0dXMgPT09ICdZZWxsb3cnKSB7XG4gICAgICAgICRjb21tZW50YXJ5Qm94LmNzcygnYmFja2dyb3VuZC1jb2xvcicsICcjRkYwMDAwJyk7XG4gICAgICAgICRjb21tZW50YXJ5Qm94LmNzcygnY29sb3InLCAnI0ZGRkZGRicpO1xuICAgICAgICAvLyBTdG9yZSBtZXNhZ2VzIGFuZCBkZXRhaWxzIGluIGFuIGdhbWUgT2JqZWN0XG4gICAgICAgIC8vICRjb21tZW50YXJ5Qm94LnRleHQoYCR7ZGVmZW5kaW5nUGxheWVyLm5hbWV9IGdldHMgYSByZWQhYCk7XG4gICAgICAgIGdlbmVyYXRlQ29tbWVudGFyeSgnc2Vjb25kWWVsbG93JywgZGVmZW5kaW5nUGxheWVyKVxuICAgICAgICAkKGAjJHt0ZWFtfUV2ZW50c2ApLmFwcGVuZChgPGkgY2xhc3M9J2ZhIGZhLXNxdWFyZSBldmVudC1pdGVtJyBzdHlsZT0nZm9udC1zaXplOiAyNHB4OyBjb2xvcjogcmVkOyBwYWRkaW5nLXRvcDo1cHgnIGFyaWEtaGlkZGVuPSd0cnVlJz48L2k+ICR7bWF0Y2hUaW1lfSBtaW5zOiAke2RlZmVuZGluZ1BsYXllci5uYW1lfSBzZW50IG9mZjxici8+YCk7XG5cbiAgICAgICAgZGVmZW5kaW5nUGxheWVyLnN0YXR1cyA9ICdFamVjdGVkJztcbiAgICAgICAgZGVmZW5kaW5nUGxheWVyLnBsYXlpbmcgPSBmYWxzZTtcblxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgJGNvbW1lbnRhcnlCb3guY3NzKCdiYWNrZ3JvdW5kLWNvbG9yJywgJ3llbGxvdycpO1xuICAgICAgICAkY29tbWVudGFyeUJveC5jc3MoJ2NvbG9yJywgJyMwMDAwMDAnKTtcbiAgICAgICAgLy8gJGNvbW1lbnRhcnlCb3gudGV4dChgJHtkZWZlbmRpbmdQbGF5ZXIubmFtZX0gZ2V0cyBhIHllbGxvdyFgKTtcbiAgICAgICAgZ2VuZXJhdGVDb21tZW50YXJ5KCd5ZWxsb3cnLCBkZWZlbmRpbmdQbGF5ZXIpXG5cbiAgICAgICAgLy8gU3RvcmUgbWVzYWdlcyBhbmQgZGV0YWlscyBpbiBhbiBnYW1lIE9iamVjdFxuICAgICAgICAkKGAjJHt0ZWFtfUV2ZW50c2ApLmFwcGVuZChgXG4gICAgICAgICAgPGkgY2xhc3M9J2ZhIGZhLXNxdWFyZSBldmVudC1pdGVtJyBzdHlsZT0nZm9udC1zaXplOiAyNHB4OyBjb2xvcjogeWVsbG93OyBwYWRkaW5nLXRvcDo1cHgnIGFyaWEtaGlkZGVuPSd0cnVlJz48L2k+ICR7bWF0Y2hUaW1lfSBtaW5zOiAke2RlZmVuZGluZ1BsYXllci5uYW1lfSBib29rZWQ8YnIvPmApO1xuXG4gICAgICAgIGRlZmVuZGluZ1BsYXllci5zdGF0dXMgPSAnWWVsbG93JztcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBoYW5kbGVJbmp1cnkoYXR0YWNraW5nVGVhbSwgdGVhbVN0cmluZykge1xuICAgIGNvbnN0IGF0dGFja2luZ1BsYXllciA9IGF0dGFja2luZ1RlYW0ucmFuZG9tUGxheWVyKCk7XG4gICAgLy8gVEhFUkUgQ09VTEQgQkUgQU4gSU5KVVJZXG4gICAgaWYgKGdlblJhbmRvbVZhbHVlKDEwMSkgJSA4ID09PSAwKSB7XG4gICAgICAvLyAkY29tbWVudGFyeUJveC50ZXh0KGAke2F0dGFja2luZ1BsYXllci5uYW1lfSBnZXRzIHRha2VuIG9mZiBvbiBhIHN0cmV0Y2hlciFgKTtcbiAgICAgIGdlbmVyYXRlQ29tbWVudGFyeSgnaW5qdXJ5JywgYXR0YWNraW5nUGxheWVyKTtcbiAgICAgICQoYCMke3RlYW1TdHJpbmd9RXZlbnRzYCkuYXBwZW5kKGA8aSBjbGFzcz0nZmEgZmEtcGx1cycgc3R5bGU9J2ZvbnQtc2l6ZTogMjZweDsgY29sb3I6IGdyZWVuOyBwYWRkaW5nLXRvcDo1cHgnIGFyaWEtaGlkZGVuPSd0cnVlJz48L2k+ICR7bWF0Y2hUaW1lfSBtaW5zOiAke2F0dGFja2luZ1BsYXllci5uYW1lfSBpbmp1cmVkPGJyLz5gKTtcbiAgICAgIGF0dGFja2luZ1BsYXllci5wbGF5aW5nID0gZmFsc2U7XG4gICAgfSBlbHNlIHtcbiAgICAgICRjb21tZW50YXJ5Qm94LnRleHQoYCR7YXR0YWNraW5nUGxheWVyLm5hbWV9J3MgbGltcGluZywgYnV0IGhlJ2xsIGJlIG9rYXlgKTtcbiAgICB9XG5cbiAgfVxuXG4gIGZ1bmN0aW9uIGhhbmRsZUZyZWVraWNrKGF0dGFja2luZ1RlYW0sIHRlYW1TdHJpbmcsIGRlZmVuZGluZ1RlYW0pIHtcbiAgICBjb25zdCBhdHRhY2tpbmdQbGF5ZXIgPSBhdHRhY2tpbmdUZWFtLnJhbmRvbVBsYXllckJ5UG9zaXRpb24oJ21pZGZpZWxkZXInKTtcbiAgICBjb25zdCBkZWZlbmRpbmdWYWx1ZSA9IChkZWZlbmRpbmdUZWFtLnJhbmRvbVBsYXllckJ5UG9zaXRpb24oJ2dvYWxrZWVwZXInKS5kZWZlbmNlICsgZGVmZW5kaW5nVGVhbS5hdmVyYWdlUGxheWVyVmFsdWVzKCdkZWZlbmRlcicpKTtcblxuICAgIGlmIChhdHRhY2tpbmdQbGF5ZXIuYXR0YWNrID4gZGVmZW5kaW5nVmFsdWUpIHtcbiAgICAgIC8vIFJlZmFjdG9yIHRoaXNcbiAgICAgIGxldCBzY29yZSA9IG51bGw7XG4gICAgICBsZXQgZ2V0U2NvcmUgPSBudWxsO1xuICAgICAgaWYgKHRlYW1TdHJpbmcgPT09ICdob21lJykge1xuICAgICAgICBnZXRTY29yZSA9ICRob21lU2NvcmUudGV4dCgpO1xuICAgICAgICBzY29yZSA9IHBhcnNlRmxvYXQoZ2V0U2NvcmUpICsgMTtcbiAgICAgICAgJGhvbWVTY29yZS50ZXh0KHNjb3JlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGdldFNjb3JlID0gJGF3YXlTY29yZS50ZXh0KCk7XG4gICAgICAgIHNjb3JlID0gcGFyc2VGbG9hdChnZXRTY29yZSkgKyAxO1xuICAgICAgICAkYXdheVNjb3JlLnRleHQoc2NvcmUpO1xuICAgICAgfVxuXG4gICAgICAvLyRjb21tZW50YXJ5Qm94LnRleHQoYEl0J3MgYSB3b25kZXIgZ29hbCEgR29hbCFgKTtcbiAgICAgIGdlbmVyYXRlQ29tbWVudGFyeSgnZnJlZWtpY2snLCBhdHRhY2tpbmdQbGF5ZXIpO1xuICAgICAgJChgIyR7dGVhbVN0cmluZ31FdmVudHNgKS5hcHBlbmQoYDxpIGNsYXNzPSdmYSBmYS1mdXRib2wtbycgc3R5bGU9J2ZvbnQtc2l6ZTogMjJweDsgY29sb3I6d2hpdGU7IHBhZGRpbmctdG9wOjVweCcgYXJpYS1oaWRkZW49J3RydWUnPjwvaT4gJHttYXRjaFRpbWV9IG1pbnM6ICR7YXR0YWNraW5nUGxheWVyLm5hbWV9IHNjb3JlZDxici8+YCk7XG5cbiAgICB9IGVsc2Uge1xuICAgICAgZ2VuZXJhdGVDb21tZW50YXJ5KCd3YXN0ZWRGcmVla2ljaycsIGF0dGFja2luZ1BsYXllcik7XG4gICAgfVxuICB9XG4gIGZ1bmN0aW9uIGhhbmRsZVBlbmFsdHkoYXR0YWNraW5nVGVhbSwgdGVhbVN0cmluZywgZGVmZW5kaW5nVGVhbSkge1xuXG4gICAgY29uc3QgYXR0YWNraW5nUGxheWVyID0gYXR0YWNraW5nVGVhbS5yYW5kb21QbGF5ZXJCeVBvc2l0aW9uKCdzdHJpa2VyJyk7XG4gICAgY29uc3QgZGVmZW5kaW5nUGxheWVyID0gZGVmZW5kaW5nVGVhbS5yYW5kb21QbGF5ZXJCeVBvc2l0aW9uKCdnb2Fsa2VlcGVyJyk7XG4gICAgY29uc3QgYm9va2VkUGxheWVyID0gZGVmZW5kaW5nVGVhbS5yYW5kb21QbGF5ZXJCeVBvc2l0aW9uKCdkZWZlbmRlcicpO1xuICAgIGNvbnN0IHRlYW0gPSB0ZWFtU3RyaW5nID09PSAnaG9tZScgPyAnYXdheScgOiAnaG9tZSc7XG4gICAgLy8gQm9vayB0aGUgcGxheWVyP1xuICAgIGlmIChnZW5SYW5kb21WYWx1ZSgxMDApID4gMjUpIHtcbiAgICAgIC8vIGNvbnNvbGUubG9nKCdoZXJlJyk7XG4gICAgICBib29rZWRQbGF5ZXIuc3RhdHVzID0gJ1llbGxvdyc7XG4gICAgICAkKGAjJHt0ZWFtfUV2ZW50c2ApLmFwcGVuZChgPGkgY2xhc3M9J2ZhIGZhLXNxdWFyZSBldmVudC1pdGVtJyBzdHlsZT0nZm9udC1zaXplOiAyNHB4OyBjb2xvcjogeWVsbG93OyBwYWRkaW5nLXRvcDo1cHgnIGFyaWEtaGlkZGVuPSd0cnVlJz48L2k+ICR7bWF0Y2hUaW1lfSBtaW5zOiAke2Jvb2tlZFBsYXllci5uYW1lfSBib29rZWQ8YnIvPmApO1xuICAgIH1cblxuICAgIGlmICgoZ2VuUmFuZG9tVmFsdWUoYXR0YWNraW5nUGxheWVyLmF0dGFjaykqMikgPiBnZW5SYW5kb21WYWx1ZShkZWZlbmRpbmdQbGF5ZXIuZGVmZW5jZSkpIHtcblxuICAgICAgbGV0IHNjb3JlID0gbnVsbDtcbiAgICAgIGxldCBnZXRTY29yZSA9IG51bGw7XG4gICAgICBpZiAodGVhbVN0cmluZyA9PT0gJ2hvbWUnKSB7XG4gICAgICAgIGdldFNjb3JlID0gJGhvbWVTY29yZS50ZXh0KCk7XG4gICAgICAgIHNjb3JlID0gcGFyc2VGbG9hdChnZXRTY29yZSkgKyAxO1xuICAgICAgICAkaG9tZVNjb3JlLnRleHQoc2NvcmUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZ2V0U2NvcmUgPSAkYXdheVNjb3JlLnRleHQoKTtcbiAgICAgICAgc2NvcmUgPSBwYXJzZUZsb2F0KGdldFNjb3JlKSArIDE7XG4gICAgICAgICRhd2F5U2NvcmUudGV4dChzY29yZSk7XG4gICAgICB9XG5cbiAgICAgIC8vICRjb21tZW50YXJ5Qm94LnRleHQoYCR7YXR0YWNraW5nUGxheWVyLm5hbWV9J3MgY2xpbmljYWwgZnJvbSB0aGUgc3BvdCEgR29hbCFgKTtcbiAgICAgIGdlbmVyYXRlQ29tbWVudGFyeSgncGVuYWx0eScsIGF0dGFja2luZ1BsYXllcik7XG4gICAgICAkKGAjJHt0ZWFtU3RyaW5nfUV2ZW50c2ApLmFwcGVuZChgPGkgY2xhc3M9J2ZhIGZhLWZ1dGJvbC1vJyBzdHlsZT0nZm9udC1zaXplOiAyMnB4OyBjb2xvcjp3aGl0ZTsgcGFkZGluZy10b3A6NXB4JyBhcmlhLWhpZGRlbj0ndHJ1ZSc+PC9pPiAke21hdGNoVGltZX0gbWluczogJHthdHRhY2tpbmdQbGF5ZXIubmFtZX0gc2NvcmVzIHBlbmFsdHk8YnIvPmApO1xuXG4gICAgfSBlbHNlIHtcbiAgICAgICRjb21tZW50YXJ5Qm94LnRleHQoYEhlJ3MgbWlzc2VkIGl0ISBUaGUgcHJlc3N1cmUgaGFzIGdvdCB0byBoaW1gKTtcbiAgICAgICQoYCMke3RlYW1TdHJpbmd9RXZlbnRzYCkuYXBwZW5kKGA8aSBjbGFzcz0nZmEgZmEtZnV0Ym9sLW8nIHN0eWxlPSdmb250LXNpemU6IDIycHg7IGNvbG9yOnJlZDsgcGFkZGluZy10b3A6NXB4JyBhcmlhLWhpZGRlbj0ndHJ1ZSc+PC9pPiAke21hdGNoVGltZX0gbWluczogJHthdHRhY2tpbmdQbGF5ZXIubmFtZX0gbWlzc2VkIHBlbmFsdHk8YnIvPmApO1xuXG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gc3RyYWlnaHRSZWQoZGVmZW5kaW5nVGVhbSwgdGVhbVN0cmluZykge1xuICAgIGNvbnN0IGRlZmVuZGluZ1BsYXllciA9IGRlZmVuZGluZ1RlYW0ucmFuZG9tUGxheWVyKCk7XG4gICAgaWYgKGdlblJhbmRvbVZhbHVlKGRlZmVuZGluZ1BsYXllci5kaXNjaXBsaW5lKSA+IDc1KSB7XG4gICAgICBkZWZlbmRpbmdQbGF5ZXIucGxheWluZyA9IGZhbHNlO1xuICAgICAgY29uc3QgdGVhbSA9IHRlYW1TdHJpbmcgPT09ICdob21lJyA/ICdhd2F5JyA6ICdob21lJztcbiAgICAgIC8vICRjb21tZW50YXJ5Qm94LnRleHQoJ1RoZSByZWZlcmVlIGdpdmVzIGhpbSBhIHN0cmFpZ2h0IHJlZCEnKTtcbiAgICAgIGdlbmVyYXRlQ29tbWVudGFyeSgnc3RyYWlnaHRSZWQnLCBkZWZlbmRpbmdQbGF5ZXIpO1xuICAgICAgJChgIyR7dGVhbX1FdmVudHNgKS5hcHBlbmQoYDxpIGNsYXNzPSdmYSBmYS1zcXVhcmUnIHN0eWxlPSdmb250LXNpemU6IDI0cHg7IGNvbG9yOiByZWQ7IHBhZGRpbmctdG9wOjVweCcgYXJpYS1oaWRkZW49J3RydWUnPjwvaT4gJHttYXRjaFRpbWV9IG1pbnM6ICR7ZGVmZW5kaW5nUGxheWVyLm5hbWV9IHNlbnQgb2ZmPGJyLz5gKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBjb25maWdUZWFtKHRlYW0sIHNlbGVjdG9yKSB7XG4gICAgaWYgKGhvbWVUZWFtID09PSBudWxsKSB7XG4gICAgICAkKCcuaG9tZS10ZWFtICAudGVhbS1uYW1lJykudGV4dChzZWxlY3Rvcik7XG4gICAgICBzd2l0Y2ggKHNlbGVjdG9yKSB7XG4gICAgICAgIGNhc2UgJ1RvdHRlbmhhbSc6XG4gICAgICAgICAgaG9tZVRlYW0gPSBzcHVycztcbiAgICAgICAgICAkKCcuaG9tZS10ZWFtLCAjaG9tZUJhcicpLmNzcygnYmFja2dyb3VuZC1jb2xvcicsIGhvbWVUZWFtLmNvbG9yc1swXSk7XG4gICAgICAgICAgJCgnLmhvbWUtdGVhbScpLmNzcygnY29sb3InLCBob21lVGVhbS5jb2xvcnNbMV0pO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdNYW4gVW5pdGVkJzpcbiAgICAgICAgICBob21lVGVhbSA9IG1hblVuaXRlZDtcbiAgICAgICAgICAkKCcuaG9tZS10ZWFtLCAjaG9tZUJhcicpLmNzcygnYmFja2dyb3VuZC1jb2xvcicsIGhvbWVUZWFtLmNvbG9yc1swXSk7XG4gICAgICAgICAgJCgnLmhvbWUtdGVhbScpLmNzcygnY29sb3InLCBob21lVGVhbS5jb2xvcnNbMV0pO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdMaXZlcnBvb2wnOlxuICAgICAgICAgIGhvbWVUZWFtID0gbGl2ZXJwb29sO1xuICAgICAgICAgICQoJy5ob21lLXRlYW0sICNob21lQmFyJykuY3NzKCdiYWNrZ3JvdW5kLWNvbG9yJywgaG9tZVRlYW0uY29sb3JzWzBdKTtcbiAgICAgICAgICAkKCcuaG9tZS10ZWFtJykuY3NzKCdjb2xvcicsIGhvbWVUZWFtLmNvbG9yc1sxXSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ01hbiBDaXR5JzpcbiAgICAgICAgICBob21lVGVhbSA9IG1hbkNpdHk7XG4gICAgICAgICAgJCgnLmhvbWUtdGVhbSwgI2hvbWVCYXInKS5jc3MoJ2JhY2tncm91bmQtY29sb3InLCBob21lVGVhbS5jb2xvcnNbMF0pO1xuICAgICAgICAgICQoJy5ob21lLXRlYW0nKS5jc3MoJ2NvbG9yJywgaG9tZVRlYW0uY29sb3JzWzFdKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnRXZlcnRvbic6XG4gICAgICAgICAgaG9tZVRlYW0gPSBldmVydG9uO1xuICAgICAgICAgICQoJy5ob21lLXRlYW0sICNob21lQmFyJykuY3NzKCdiYWNrZ3JvdW5kLWNvbG9yJywgaG9tZVRlYW0uY29sb3JzWzBdKTtcbiAgICAgICAgICAkKCcuaG9tZS10ZWFtJykuY3NzKCdjb2xvcicsIGhvbWVUZWFtLmNvbG9yc1sxXSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ0NoZWxzZWEnOlxuICAgICAgICAgIGhvbWVUZWFtID0gY2hlbHNlYTtcbiAgICAgICAgICAkKCcuaG9tZS10ZWFtLCAjaG9tZUJhcicpLmNzcygnYmFja2dyb3VuZC1jb2xvcicsIGhvbWVUZWFtLmNvbG9yc1swXSk7XG4gICAgICAgICAgJCgnLmhvbWUtdGVhbScpLmNzcygnY29sb3InLCBob21lVGVhbS5jb2xvcnNbMV0pO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdMZWljZXN0ZXInOlxuICAgICAgICAgIGhvbWVUZWFtID0gbGVpY2VzdGVyO1xuICAgICAgICAgICQoJy5ob21lLXRlYW0sICNob21lQmFyJykuY3NzKCdiYWNrZ3JvdW5kLWNvbG9yJywgaG9tZVRlYW0uY29sb3JzWzBdKTtcbiAgICAgICAgICAkKCcuaG9tZS10ZWFtJykuY3NzKCdjb2xvcicsIGhvbWVUZWFtLmNvbG9yc1sxXSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ0Fyc2VuYWwnOlxuICAgICAgICAgIGhvbWVUZWFtID0gYXJzZW5hbDtcbiAgICAgICAgICAkKCcuaG9tZS10ZWFtLCAjaG9tZUJhcicpLmNzcygnYmFja2dyb3VuZC1jb2xvcicsIGhvbWVUZWFtLmNvbG9yc1swXSk7XG4gICAgICAgICAgJCgnLmhvbWUtdGVhbScpLmNzcygnY29sb3InLCBob21lVGVhbS5jb2xvcnNbMV0pO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgY29uc29sZS5sb2coaG9tZVRlYW0pO1xuICAgIH0gZWxzZSB7XG5cbiAgICAgICQoJy5hd2F5LXRlYW0gLnRlYW0tbmFtZScpLnRleHQoc2VsZWN0b3IpO1xuXG4gICAgICBzd2l0Y2ggKHNlbGVjdG9yKSB7XG4gICAgICAgIGNhc2UgJ1RvdHRlbmhhbSc6XG4gICAgICAgICAgYXdheVRlYW0gPSBzcHVycztcbiAgICAgICAgICAkKCcuYXdheS10ZWFtLCAucG9zc2Vzc2lvbi1iYXInKS5jc3MoJ2JhY2tncm91bmQtY29sb3InLCBhd2F5VGVhbS5jb2xvcnNbMF0pO1xuICAgICAgICAgICQoJy5hd2F5LXRlYW0nKS5jc3MoJ2NvbG9yJywgYXdheVRlYW0uY29sb3JzWzFdKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnTWFuIFVuaXRlZCc6XG4gICAgICAgICAgYXdheVRlYW0gPSBtYW5Vbml0ZWQ7XG4gICAgICAgICAgJCgnLmF3YXktdGVhbSwgLnBvc3Nlc3Npb24tYmFyJykuY3NzKCdiYWNrZ3JvdW5kLWNvbG9yJywgYXdheVRlYW0uY29sb3JzWzBdKTtcbiAgICAgICAgICAkKCcuYXdheS10ZWFtJykuY3NzKCdjb2xvcicsIGF3YXlUZWFtLmNvbG9yc1sxXSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ0xpdmVycG9vbCc6XG4gICAgICAgICAgYXdheVRlYW0gPSBsaXZlcnBvb2w7XG4gICAgICAgICAgJCgnLmF3YXktdGVhbSwgLnBvc3Nlc3Npb24tYmFyJykuY3NzKCdiYWNrZ3JvdW5kLWNvbG9yJywgYXdheVRlYW0uY29sb3JzWzBdKTtcbiAgICAgICAgICAkKCcuYXdheS10ZWFtJykuY3NzKCdjb2xvcicsIGF3YXlUZWFtLmNvbG9yc1sxXSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ01hbiBDaXR5JzpcbiAgICAgICAgICBhd2F5VGVhbSA9IG1hbkNpdHk7XG4gICAgICAgICAgJCgnLmF3YXktdGVhbSwgLnBvc3Nlc3Npb24tYmFyJykuY3NzKCdiYWNrZ3JvdW5kLWNvbG9yJywgYXdheVRlYW0uY29sb3JzWzBdKTtcbiAgICAgICAgICAkKCcuYXdheS10ZWFtJykuY3NzKCdjb2xvcicsIGF3YXlUZWFtLmNvbG9yc1sxXSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ0V2ZXJ0b24nOlxuICAgICAgICAgIGF3YXlUZWFtID0gZXZlcnRvbjtcbiAgICAgICAgICAkKCcuYXdheS10ZWFtLCAucG9zc2Vzc2lvbi1iYXInKS5jc3MoJ2JhY2tncm91bmQtY29sb3InLCBhd2F5VGVhbS5jb2xvcnNbMF0pO1xuICAgICAgICAgICQoJy5hd2F5LXRlYW0nKS5jc3MoJ2NvbG9yJywgYXdheVRlYW0uY29sb3JzWzFdKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnQ2hlbHNlYSc6XG4gICAgICAgICAgYXdheVRlYW0gPSBjaGVsc2VhO1xuICAgICAgICAgICQoJy5hd2F5LXRlYW0sIC5wb3NzZXNzaW9uLWJhcicpLmNzcygnYmFja2dyb3VuZC1jb2xvcicsIGF3YXlUZWFtLmNvbG9yc1swXSk7XG4gICAgICAgICAgJCgnLmF3YXktdGVhbScpLmNzcygnY29sb3InLCBhd2F5VGVhbS5jb2xvcnNbMV0pO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdMZWljZXN0ZXInOlxuICAgICAgICAgIGF3YXlUZWFtID0gbGVpY2VzdGVyO1xuICAgICAgICAgICQoJy5hd2F5LXRlYW0sIC5wb3NzZXNzaW9uLWJhcicpLmNzcygnYmFja2dyb3VuZC1jb2xvcicsIGF3YXlUZWFtLmNvbG9yc1swXSk7XG4gICAgICAgICAgJCgnLmF3YXktdGVhbScpLmNzcygnY29sb3InLCBhd2F5VGVhbS5jb2xvcnNbMV0pO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdBcnNlbmFsJzpcbiAgICAgICAgICBhd2F5VGVhbSA9IGFyc2VuYWw7XG4gICAgICAgICAgJCgnLmF3YXktdGVhbSwgLnBvc3Nlc3Npb24tYmFyJykuY3NzKCdiYWNrZ3JvdW5kLWNvbG9yJywgYXdheVRlYW0uY29sb3JzWzBdKTtcbiAgICAgICAgICAkKCcuYXdheS10ZWFtJykuY3NzKCdjb2xvcicsIGF3YXlUZWFtLmNvbG9yc1sxXSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBjb25zb2xlLmxvZyhhd2F5VGVhbSk7XG4gICAgfVxuXG4gICAgY29uc29sZS5sb2coc2VsZWN0b3IpO1xuICAgIC8vIFBhc3MgaW4gdGhlIG9iamVjdCB2YWx1ZXMgdG8gaG9tZVRlYW1cbiAgfVxuXG4gIGZ1bmN0aW9uIGdlbmVyYXRlQ29tbWVudGFyeShzY2VuYXJpbywgcGxheWVyKSB7XG4gICAgY29uc3QgY29tbWVudGFyeSA9IHtcbiAgICAgIGdvYWw6IFsnR29hbCEnLCAnSGVcXCdzIHNjb3JlZCEnLCBgVGhhdCdzIGEgZ3JlYXQgZmluaXNoIWAsIGBXaGF0IGEgZ29hbCBieSAke3BsYXllci5uYW1lfWAsIGAke3BsYXllci5uYW1lfSBmaW5pc2hlcyBvZmYgdGhlIG1vdmUhYF0sXG4gICAgICBmcmVla2ljazogW2BJdCdzIGEgZnJlZWtpY2tgLCBgJHtwbGF5ZXIubmFtZX0gdG8gdGFrZSB0aGUgZnJlZWtpY2tgLCBgSGUgbGluZXMgdXAgdGhlIGZyZWVraWNrYCwgYFRoaXMgaXMgYSBjaGFuY2UgdG8gZ2V0IGEgY3Jvc3MgaW5gXSxcbiAgICAgIHdhc3RlZEZyZWVraWNrOiBbYCR7cGxheWVyLm5hbWV9IGxvc2VzIHBvc3Nlc3Npb25gLCBgVGhhdCdzIGVuZGVkIHVwIGluIHJvdyBaYCwgYFRoZSBhdHRhY2sgYW1vdW50cyB0byBub3RoaW5nYCwgYCR7cGxheWVyLm5hbWV9IGhhcyB3YXN0ZWQgdGhhdCBvcHBvcnR1bml0eWAsIGAke3BsYXllci5uYW1lfSdzIGVmZm9ydCBnb2VzIG92ZXIgdGhlIGJhcmAsIGBIZSBoYW5kcyBiYWNrIHBvc3Nlc3Npb24gdG8gdGhlIG90aGVyIHRlYW1gXSxcbiAgICAgIHllbGxvdzogW2BIZSdzIGdvaW5nIGluIHRoZSBib29rYCwgYE91Y2ghICR7cGxheWVyLm5hbWV9J2xsIGEgeWVsbG93IGZvciB0aGF0YCwgYFRoYXQncyBhIGJvb2tpbmdgLCBgSXQncyBhIHllbGxvdyFgLCBgVGhlIHJlZiBpcyB0YWtpbmcgaGlzIG5hbWVgXSxcbiAgICAgIHNlY29uZFllbGxvdzogW2BIZSdzIGFscmVhZHkgYmVlbiBib29rZWQuLi5gLCBgVGhhdCdzIGEgc2Vjb25kIHllbGxvd2AsIGAke3BsYXllci5uYW1lfSBpcyBzaG93biBhIHJlZCFgLCBgJHtwbGF5ZXIubmFtZX0gaXMgb2ZmYF0sXG4gICAgICBzdHJhaWdodFJlZDogW2Ake3BsYXllci5uYW1lfSBpcyBzaG93biBhIHN0cmFpZ2h0IHJlZCFgLCBgJHtwbGF5ZXIubmFtZX0gaXMgb2ZmYCwgYFRoZSByZWYgaGFzIGdpdmVuIGhpbSBzdHJhaWdodCByZWQhYF0sXG4gICAgICBwZW5hbHR5OiBbYFRoZSByZWZlcmVlIHBvaW50cyB0byB0aGUgc3BvdGAsIGBUaGF0J3MgYSBwZW5hbHR5YCwgYCR7cGxheWVyLm5hbWV9IGlzIGZvdWxlZCBpbiB0aGUgYXJlYWAsIGBUaGUgcmVmIGJsb3dzIGhpcyB3aGlzdGxlLiBQZW5hbHR5LmBdLFxuICAgICAgaW5qdXJ5OiBbYCR7cGxheWVyLm5hbWV9J3MgaXMgZ29pbmcgb2ZmYCxgJHtwbGF5ZXIubmFtZX0gaXMgaW5qdXJlZGAsYCR7cGxheWVyLm5hbWV9IGNhbid0IGNvbnRpbnVlYF1cbiAgICB9O1xuICAgIGNvbnN0IHJhbmRvbWVJbmRleCA9IGdlblJhbmRvbVZhbHVlKGNvbW1lbnRhcnlbc2NlbmFyaW9dLmxlbmd0aCk7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNvbW1lbnRhcnlbc2NlbmFyaW9dW3JhbmRvbWVJbmRleF07XG4gICAgJGNvbW1lbnRhcnlCb3gudGV4dChgJHttZXNzYWdlfWApO1xuXG4gIH1cblxufSk7XG4iXX0=
